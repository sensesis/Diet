<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <!-- CSS 파일을 불러오는 링크 (경로가 올바른지 확인 필요) -->
    <link href="/main.css" rel="stylesheet">

    <!-- 구글 폰트 불러오기 -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;800&display=swap" rel="stylesheet">
</head>
<body>

<!-- 네비게이션 바를 Thymeleaf 템플릿으로 가져옴 -->
<div th:replace="~{nav.html :: navbar}"></div>
<a href="/signup">SignUp</a>

<!-- 상품 리스트를 출력하는 부분 (Thymeleaf 반복문) -->
<div class="card" th:each="i : ${cloths}">
    <img src="https://placehold.co/300" alt="Cloth Image">
    <div>
        <h4>ID: <span th:text="${i.id}"></span></h4>
        <h4>Name: <span th:text="${i.name}"></span></h4>
        <h4>Type: <span th:text="${i.type}"></span></h4>
        <a th:href="@{/edit/{id}(id=${i.id})}">수정</a>
        <span style="cursor: pointer;" data-id="[[${i.id}]]" onclick="deleteCloth(this)">🗑️</span>
    </div>
</div>
<script>
    function deleteCloth(element) {
        // 클릭된 span 요소에서 data-id 값을 가져옴
        const id = element.getAttribute("data-id");

        if (confirm('정말로 삭제하시겠습니까?')) {
            fetch(`/cloth/${id}`, {
                method: 'DELETE'
            })
                .then(response => {
                    if (response.ok) {
                        alert('삭제되었습니다.');
                        location.reload(); // 삭제 후 페이지 새로고침
                    } else {
                        alert('삭제 실패');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
    }


</script>

</body>
</html>
